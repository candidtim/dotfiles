#!/bin/bash

if [ -z "$1" ]; then
  current=$(grep -o 'background=[a-zA-Z]*' ~/.config/nvim/init.vim | cut -d= -f2)
  theme=${current:-dark}
  [[ "$theme" == "dark" ]] && theme="light" || theme="dark"
else
  theme=$1
fi

echo "Switching to $theme theme."

sed -i '' "s/background=[a-zA-Z]*/background=$theme/" ~/.config/nvim/init.vim
sed -i '' "s/solarized_[a-zA-Z]*/solarized_$theme/" ~/.config/nvim/lua/init.lua

sed -i '' "s/@colors-solarized '[a-zA-Z]*'/@colors-solarized '$theme'/" ~/.tmux.conf
tmux source-file ~/.tmux.conf

if [[ -f ~/Library/Application\ Support/com.mitchellh.ghostty/config ]]; then
  sed -i '' "s/Builtin Solarized [a-zA-Z]*/Builtin Solarized ${theme}/" ~/Library/Application\ Support/com.mitchellh.ghostty/config
elif [[ -f "$XDG_CONFIG_HOME/ghostty/config" ]]; then
  sed -i '' "s/Builtin Solarized [a-zA-Z]*/Builtin Solarized ${theme}/" "$XDG_CONFIG_HOME/ghostty/config"
fi

echo "Cmd+Shift+, to reload the theme."
