#!/bin/bash

if [ -z "$1" ]; then
  current=$(grep -o 'background=[a-zA-Z]*' ~/.config/nvim/init.vim | cut -d= -f2)
  theme=${current:-dark}
  [[ "$theme" == "dark" ]] && theme="light" || theme="dark"
else
  theme=$1
fi

echo "Switching to $theme theme."

if [[ "$(uname -s)" == "Darwin" ]]; then
  SED_INPLACE="-i ''"
  GHOSTTY_CONIFG="~/Library/Application Support/com.mitchellh.ghostty/config"
else
  SED_INPLACE="-i"
  GHOSTTY_CONIFG=~/.config/ghostty/config
fi

# Vim:
sed $SED_INPLACE "s/background=[a-zA-Z]*/background=$theme/" ~/.config/nvim/init.vim
sed $SED_INPLACE "s/solarized_[a-zA-Z]*/solarized_$theme/" ~/.config/nvim/lua/init.lua

# tmux:
sed $SED_INPLACE "s/@colors-solarized '[a-zA-Z]*'/@colors-solarized '$theme'/" ~/.tmux.conf
tmux source-file ~/.tmux.conf

# Ghostty:
sed $SED_INPLACE "s/Builtin Solarized [a-zA-Z]*/Builtin Solarized ${theme}/" $GHOSTTY_CONIFG
echo "Super+Shift+, to reload the theme."
